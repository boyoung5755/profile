<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="profile.file.dao.FileDAO">

	<insert id="insertProfileFile"  parameterType="FileVO">
		INSERT INTO file(
			file_code
			, file_name
			, file_sn
			, file_mime
			, file_size
			, file_fancysize
			, file_rdate
			, file_path
			, show_profileimg
		)
		VALUES(
			#{fileCode}
			, #{fileName}
			, #{fileSn}
			, #{fileMime}
			, #{fileSize}
			, #{fileFancysize}
			, #{fileRdate}
			, #{filePath}
			, COALESCE(#{showProfileimg},"N")
			
		)
	</insert>
	
	<select id="selectFileName" parameterType="String" resultType="FileVO">
		SELECT *
		FROM FILE
		WHERE FILE_NO=#{fileNo}
	</select>
	
	
	
	<sql id="searchFrag">
    	<if test="simpleCondition neq null and @org.apache.commons.lang3.StringUtils@isNotBlank(simpleCondition.searchWord)">
    		<choose>
    			<when test="simpleCondition.searchType eq 'title'">
    				WHERE INSTR(FIlE_NAME, #{simpleCondition.searchWord}) > 0
    			</when>
    			<otherwise>
    				WHERE
    				(
	   					INSTR(FIlE_NAME, #{simpleCondition.searchWord}) > 0
    				)
    			</otherwise>
    		</choose>
    	</if>
	</sql>
	
	<select id="selectFileList" parameterType="PaginationInfo" resultType="FileVO">
		SELECT
			@rownum:=@rownum+1 as rnum
			, b.*
		FROM file b
		WHERE (@rownum:=0)=0
		limit #{endRow} OFFSET #{startRow}
	</select>
	
	<select id="selectTotalRecord" resultType="int" parameterType="PaginationInfo">
		SELECT
			COUNT(*)
		FROM File
	</select>
	
	

</mapper>